$(function () { function e(l) { var k = 0; $(l).each(function () { k += $(this).outerWidth(true) }); return k } function f(n) { var o = e($(n).prevAll()), q = e($(n).nextAll()); var l = e($(".content-tabs").children().not(".J_menuTabs")); var k = $(".content-tabs").outerWidth(true) - l; var p = 0; if ($(".page-tabs-content").outerWidth() < k) { p = 0 } else { if (q <= (k - $(n).outerWidth(true) - $(n).next().outerWidth(true))) { if ((k - $(n).next().outerWidth(true)) > q) { p = o; var m = n; while ((p - $(m).outerWidth()) > ($(".page-tabs-content").outerWidth() - k)) { p -= $(m).prev().outerWidth(); m = $(m).prev() } } } else { if (o > (k - $(n).outerWidth(true) - $(n).prev().outerWidth(true))) { p = o - $(n).prev().outerWidth(true) } } } $(".page-tabs-content").animate({ marginLeft: 0 - p + "px" }, "fast") } function a() { var o = Math.abs(parseInt($(".page-tabs-content").css("margin-left"))); var l = e($(".content-tabs").children().not(".J_menuTabs")); var k = $(".content-tabs").outerWidth(true) - l; var p = 0; if ($(".page-tabs-content").width() < k) { return false } else { var m = $(".J_menuTab:first"); var n = 0; while ((n + $(m).outerWidth(true)) <= o) { n += $(m).outerWidth(true); m = $(m).next() } n = 0; if (e($(m).prevAll()) > k) { while ((n + $(m).outerWidth(true)) < (k) && m.length > 0) { n += $(m).outerWidth(true); m = $(m).prev() } p = e($(m).prevAll()) } } $(".page-tabs-content").animate({ marginLeft: 0 - p + "px" }, "fast") } function b() { var o = Math.abs(parseInt($(".page-tabs-content").css("margin-left"))); var l = e($(".content-tabs").children().not(".J_menuTabs")); var k = $(".content-tabs").outerWidth(true) - l; var p = 0; if ($(".page-tabs-content").width() < k) { return false } else { var m = $(".J_menuTab:first"); var n = 0; while ((n + $(m).outerWidth(true)) <= o) { n += $(m).outerWidth(true); m = $(m).next() } n = 0; while ((n + $(m).outerWidth(true)) < (k) && m.length > 0) { n += $(m).outerWidth(true); m = $(m).next() } p = e($(m).prevAll()); if (p > 0) { $(".page-tabs-content").animate({ marginLeft: 0 - p + "px" }, "fast") } } } $(".J_menuItem").each(function (k) { if (!$(this).attr("data-index")) { $(this).attr("data-index", k) } }); function c() { var o = $(this).attr("href"), m = $(this).data("index"), l = $.trim($(this).text()), k = true; if (!$(this).parent("li").hasClass(".nav_li_on")) { $(this).parent("li").addClass("nav_li_on").unbind("hover").siblings().removeClass("nav_li_on"); $(this).parent("li").parents(".menu-nav").siblings().find("li").removeClass("nav_li_on") } if (o == undefined || $.trim(o).length == 0) { return false } $(".J_menuTab").each(function () { if ($(this).data("id") == o) { if (!$(this).hasClass("active")) { $(this).addClass("active").siblings(".J_menuTab").removeClass("active"); f(this); $(".J_mainContent .J_iframe").each(function () { if ($(this).data("id") == o) { $(this).show().siblings(".J_iframe").hide(); return false } }) } k = false; return false } }); if (k) { var p = '<a href="javascript:;" class="active J_menuTab" data-id="' + o + '"><i class="icon-close"></i>' + l + " </a>"; $(".J_menuTab").removeClass("active"); var n = '<iframe class="J_iframe" name="iframe' + m + '" width="100%" height="100%" src="' + o + '" frameborder="0" data-id="' + o + '" seamless></iframe>'; $(".J_mainContent").find("iframe.J_iframe").hide().parents(".J_mainContent").append(n); $(".J_menuTabs .page-tabs-content").append(p); f($(".J_menuTab.active")) } return false } $(".J_menuItem").on("click", c); function g() { var m = $(this).parents(".J_menuTab").data("id"); var l = $(this).parents(".J_menuTab").width(); if ($(this).parents(".J_menuTab").hasClass("active")) { if ($(this).parents(".J_menuTab").next(".J_menuTab").size()) { var k = $(this).parents(".J_menuTab").next(".J_menuTab:eq(0)").data("id"); $(this).parents(".J_menuTab").next(".J_menuTab:eq(0)").addClass("active"); $(".J_mainContent .J_iframe").each(function () { if ($(this).data("id") == k) { $(this).show().siblings(".J_iframe").hide(); j(k); return false } }); var n = parseInt($(".page-tabs-content").css("margin-left")); if (n < 0) { $(".page-tabs-content").animate({ marginLeft: (n + l) + "px" }, "fast") } $(this).parents(".J_menuTab").remove(); $(".J_mainContent .J_iframe").each(function () { if ($(this).data("id") == m) { $(this).remove(); return false } }) } if ($(this).parents(".J_menuTab").prev(".J_menuTab").size()) { var k = $(this).parents(".J_menuTab").prev(".J_menuTab:last").data("id"); $(this).parents(".J_menuTab").prev(".J_menuTab:last").addClass("active"); $(".J_mainContent .J_iframe").each(function () { if ($(this).data("id") == k) { $(this).show().siblings(".J_iframe").hide(); j(k); return false } }); $(this).parents(".J_menuTab").remove(); $(".J_mainContent .J_iframe").each(function () { if ($(this).data("id") == m) { $(this).remove(); return false } }) } } else { $(this).parents(".J_menuTab").remove(); $(".J_mainContent .J_iframe").each(function () { if ($(this).data("id") == m) { $(this).remove(); return false } }); f($(".J_menuTab.active")) } return false } $(".J_menuTabs").on("click", ".J_menuTab i", g); function h() { $(".page-tabs-content").children("[data-id]").not(":first").not(".active").each(function () { $('.J_iframe[data-id="' + $(this).data("id") + '"]').remove(); $(this).remove() }); $(".page-tabs-content").css("margin-left", "0") } $(".J_tabCloseOther").on("click", h); function i() { f($(".J_menuTab.active")) } $(".J_tabShowActive").on("click", i); function d() { if (!$(this).hasClass("active")) { var k = $(this).data("id"); $(".J_mainContent .J_iframe").each(function () { if ($(this).data("id") == k) { $(this).show().siblings(".J_iframe").hide(); return false } }); $(this).addClass("active").siblings(".J_menuTab").removeClass("active"); f(this); j(k) } } function j(k) { var l = $("a[href='" + k + "']").parent("li"); if (!l.hasClass("nav_li_on")) { l.addClass("nav_li_on").unbind("hover").siblings().removeClass("nav_li_on"); l.parents(".menu-nav").siblings().find("li").removeClass("nav_li_on") } } $(".J_menuTabs").on("click", ".J_menuTab", d); $(".J_tabLeft").on("click", a); $(".J_tabRight").on("click", b); $("body").on("click", ".J_tabCloseAll", function () { $(".page-tabs-content").children("[data-id]").not(":first").each(function () { $('.J_iframe[data-id="' + $(this).data("id") + '"]').remove(); $(this).remove() }); $(".page-tabs-content").children("[data-id]:first").each(function () { $('.J_iframe[data-id="' + $(this).data("id") + '"]').show(); $(this).addClass("active") }); $(".page-tabs-content").css("margin-left", "0") }); $(".nav-tit").click(function () { var l = $(this).parent(); var k = $(this).siblings("ul"); if (l.hasClass("open")) { l.removeClass("open"); k.css("max-height", "0") } else { l.addClass("open"); k.css("max-height", ""); l.siblings().removeClass("open"); l.siblings().find("ul").css("max-height", "0") } }); $(".fold").click(function () { var l = $(".menu").parent(); var k = $(".con_right"); l.hasClass("mini") ? l.removeClass("mini").addClass("full") : l.removeClass("full").addClass("mini"); k.hasClass("con_mini") ? k.removeClass("con_mini").addClass("con_full") : k.removeClass("con_full").addClass("con_mini") }); $(".nav-item li").hover(function () { $(this).addClass("li_hover") }, function () { $(this).removeClass("li_hover") }); $(".nav-item li").click(function () { if (!$(this).hasClass(".nav_li_on")) { $(this).addClass("nav_li_on").unbind("hover").siblings().removeClass("nav_li_on"); $(this).parents(".menu-nav").siblings().find("li").removeClass("nav_li_on") } }); $("body").on("mouseover mouseout", ".mini .nav-tit", function (m) { if (m.type == "mouseover") { var o = $(this).offset().top; var n = $(this).offset().left; var l = $(this).find("span").text(); var k = '<div class="item-tips" style="top:' + o + "px;left:" + 60 + 'px;">' + l + "</div>"; $("body").append(k); $(".item-tips").animate({ opacity: "1" }, 300) } else { $(".item-tips").remove() } }); $("body").on("mouseover mouseout", ".mini .nav-item li", function (m) { if (m.type == "mouseover") { var o = $(this).offset().top; var n = $(this).offset().left; var l = $(this).find("span").text(); var k = '<div class="item-tips" style="top:' + o + "px;left:" + 60 + 'px;">' + l + "</div>"; $("body").append(k); $(".item-tips").animate({ opacity: "1" }, 300) } else { $(".item-tips").remove() } }); $(".J_menuTabs").on("mousedown", ".active", function (k) { if (3 == k.which) { var m = k.clientX + 5; var l = k.clientY + 5; $(".rc_menu").css({ "top": l + "px", "left": m + "px" }).show() } }); $("html").click(function () { $(".rc_menu").hide() }); $(".J_reload").click(function () { var k = $(".J_menuTabs a.active").attr("data-id"); $('iframe[data-id="' + k + '"]').attr("src", k) }) });